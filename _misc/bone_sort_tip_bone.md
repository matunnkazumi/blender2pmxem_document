---
layout: article
title: モデル情報XMLのボーン並び順指定と、つま先ボーンなど
description: モデル情報のXMLのボーンの並び順指定が、一部のボーンに反映されない件とその対処方
image: /assets/image/misc/bone_sort_tip_bone_foot.png
date: 2020-01-22 22:21:30 +0900
last_modified_at: 2020-01-22 23:21:11 +0900
---

## ボーンの並び順の指定機能

Blender2Pmx系のエクスポーターでは、PMX形式の情報の一部をXMLファイルに保存し、再エクスポート時に反映させることができます。

blender2pmxemでは、そのXMLファイルを利用して、ボーンの並び順を指定できる機能を追加しました。

ですが……

## 一部のボーンはその順序が反映されません

その現象が発生している例。つま先ボーンの位置が反映されていません。

![XMLの順に並んでいないつま先ボーン](/assets/image/misc/bone_sort_tip_bone_order.png)

つま先ボーンは、エクスポーターが自動的に追加するボーンの一つです。

## 対処方法：Blender側でそのボーンを追加しておくと順序が反映されます

Blender側で予めそのボーンを追加しておくと、XMLの指定が反映されるようになります。

つま先ボーンの場合は以下のようにします。
* 足首ボーンの直接の子ボーン
* 「接続」のチェックを入れる

![つま先ボーン設定](/assets/image/misc/bone_sort_tip_bone_toe_bone_setting.png)

## 細かい話

この現象は、IKに関連してエクスポーターが自動的に追加するボーンで発生します。

IKのエクスポート処理の詳細は以下を参照してください。

* [IKの変換](ik_between_blender_and_pmx.html)
* [IKの先ボーンの追加](add_tip_bone.html)

Blender側で予めそのボーンを追加しておいて、自動追加を行わせないことで、XMLの設定が他のボーンと同じように反映されるようになります。

この現象は、自動的に追加されるボーンへの、XML情報の反映に齟齬があることに起因します。申し訳ありませんが、現時点では仕様とさせていただきます。対応は検討中です。


